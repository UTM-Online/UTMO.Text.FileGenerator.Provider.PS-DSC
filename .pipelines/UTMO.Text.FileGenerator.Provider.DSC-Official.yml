name: ${{ parameters.MajorVersion }}.${{ parameters.MinorVersion }}$(Rev:.r)

parameters:
  - name: Configuration
    type: string
    default: Release
    values:
      - Release
      - Debug
  - name: MajorVersion
    type: string
    default: 2
  - name: MinorVersion
    type: string
    default: 1

trigger:
  batch: true
  branches:
    include:
      - main
      - release/v2
  paths:
    include:
      - src/UTMO.Text.FileGenerator.Provider.DSC/*

resources:
  repositories:
    - repository: Templates
      type: git
      name: OneBuild\OneBuild.Pipelines.v2
      ref: refs/heads/main
      endpoint: UTMO
      
variables:
  - name: Projects
    value:
      - $(RepoRoot)/src/UTMO.Text.FileGenerator.Provider.DSC/UTMO.Text.FileGenerator.Provider.DSC.csproj
      - $(RepoRoot)/src/UTMO.Text.FileGenerator.Provider.DSC.Abstract/UTMO.Text.FileGenerator.Provider.DSC.Abstract.csproj
      - $(RepoRoot)/src/UTMO.Text.FileGenerator.Provider.DSC.cChoco/UTMO.Text.FileGenerator.Provider.DSC.cChoco.csproj
      - $(RepoRoot)/src/UTMO.Text.FileGenerator.Provider.DSC.WindowsCore/UTMO.Text.FileGenerator.Provider.DSC.WindowsCore.csproj

extends:
  template: v2/Pipelines/UserTemplates/Build/Build.NugetPkg.Template.yml@Templates
  parameters:
    BuildPool: Public
    NugetConfigPath: $(RepoRoot)/src/nuget.config
    ProjectsToBuild: $(Projects)
    ProjectsToRestore: $(Projects)
    